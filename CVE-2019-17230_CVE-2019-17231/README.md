# CVE-2019-17230 Unauthenticated Stored XSS PoC

## Overview

PoC of CVE-2019-17230

WordPress Version 5.0 

[refference](https://blog.nintechnet.com/unauthenticated-stored-xss-vulnerability-in-wordpress-onetone-theme-unpatched/)

For academic demonstration purpose ONLY

## Installation

```
$ bash setup.sh
```

## Proof of Concept

1. access http://cve-2019-17230.local/ and install WordPress. you only have to create an admin account. 

3.  login to the wordpress as admin, navigate to admin panel at http://cve-2019-17230.local/wp-admin/themes.php, activate the onetone plugin.

3.  open a terminal, and run the following command:

    ```
    python exploit.py -u http://cve-2019-17230.local/
    ```

    Navigate to the front page of the wordpress at http://cve-2019-17230.local/, you would see a pop up saying xss as shown below, indicating XSS is triggered.

    ![image-20210320162847319](image/image-20210320162847319.png?raw=true)

theme-functions.php.patch contains our patch, which does authorization check and sanitization on the imported options.
