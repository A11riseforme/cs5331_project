# CVE-2019-9787 CSRF PoC

## Overview
PoC of CVE-2019-9787 CSRF to XSS to RCE

WordPress Version 5.0 

[refference](https://blog.ripstech.com/2019/wordpress-csrf-to-rce/)

For academic demonstration purpose ONLY

## Installation

```
$ bash setup.sh
```

## Proof of Concept

1. access http://cve-2019-9787.local/ and install WordPress. you only have to create an admin account. 

2. open a new private window and access http://cve-2019-9787.local/?p=1#comments as a visitor, then post comment like "check it out: http://attacker.local/". 

    ![image-20210222021757846](image\image-20210222021757846.png)

3.  login to the wordpress as admin, navigate to admin panel at http://cve-2019-9787.local/wp-admin/edit-comments.php, open the link posted by the visitor in the previous step.

4.  Refresh the page at http://cve-2019-9787.local/?p=1#comments, you would see a new comment posted by admin as shown below, indicating CSRF is triggered:

    ![image-20210222025041978](image\image-20210222025041978.png)

5.  Hover the mouse on the link, you would see a pop up saying "hello" as shown below, indicating XSS is triggered:

    ![image-20210222024957921](image\image-20210222024957921.png)

6.  Navigate to http://cve-2019-9787.local/wp-content/themes/twentysixteen/404.php, it shows a phpinfo page as shown below, indicating RCE is triggered:

    ![image-20210222025234698](image\image-20210222025234698.png)